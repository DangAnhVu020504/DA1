<div class="form-container">
    <h2>{{ isEditMode ? 'Sá»­a tin Ä‘Äƒng' : 'ThÃªm tin Ä‘Äƒng má»›i' }}</h2>

    <div *ngIf="error" class="error">{{ error }}</div>

    <form (ngSubmit)="saveProperty()" #form="ngForm">
        <div class="form-group">
            <label>TiÃªu Ä‘á» *</label>
            <input type="text" [(ngModel)]="property.title" name="title" required class="form-control">
        </div>

        <div class="form-group">
            <label>Loáº¡i hÃ¬nh *</label>
            <select [(ngModel)]="property.type" name="type" required class="form-control">
                <option value="sale">ğŸ  NhÃ  Ä‘áº¥t bÃ¡n</option>
                <option value="rent">ğŸ”‘ NhÃ  Ä‘áº¥t cho thuÃª</option>
            </select>
        </div>

        <div class="form-group">
            <label>Má»©c giÃ¡ (VND) *</label>
            <input type="number" [(ngModel)]="property.price" name="price" required class="form-control">
        </div>

        <div class="form-group">
            <label>Äá»‹a chá»‰ *</label>
            <input type="text" [(ngModel)]="property.address" name="address" required class="form-control">
        </div>

        <div class="form-group">
            <label>MÃ´ táº£ chi tiáº¿t</label>
            <textarea [(ngModel)]="property.description" name="description" rows="5" class="form-control"></textarea>
        </div>

        <div class="form-group">
            <label>ğŸ“¸ HÃ¬nh áº£nh (chá»n tá»‘i Ä‘a 5 áº£nh)</label>
            <input type="file" (change)="onFilesSelected($event)" accept="image/*" multiple class="form-control-file">

            <!-- Existing Image Preview (Edit Mode) -->
            <img *ngIf="property.imageUrl && imagePreviews.length === 0"
                [src]="'http://localhost:3000' + property.imageUrl" class="preview-img">

            <!-- New Images Preview Grid -->
            <div class="image-preview-grid" *ngIf="imagePreviews.length > 0">
                <div class="image-preview-item" *ngFor="let preview of imagePreviews; let i = index">
                    <img [src]="preview" alt="Preview">
                    <button type="button" class="remove-btn" (click)="removeImage(i)">âœ•</button>
                </div>
            </div>
            <small class="text-muted">ÄÃ£ chá»n {{ selectedFiles.length }}/5 áº£nh</small>
        </div>

        <div class="form-group">
            <label>ğŸ¬ Video giá»›i thiá»‡u (MP4, WebM - tá»‘i Ä‘a 100MB)</label>
            <input type="file" (change)="onVideoSelected($event)" accept="video/mp4,video/webm,video/quicktime"
                class="form-control-file">

            <!-- Existing Video Preview (Edit Mode) -->
            <div *ngIf="property.videoUrl" class="video-preview">
                <video [src]="'http://localhost:3000' + property.videoUrl" controls width="200"></video>
            </div>

            <!-- New Video Selected -->
            <small *ngIf="selectedVideoFile" class="text-muted">âœ… ÄÃ£ chá»n video: {{ selectedVideoFile.name }}</small>
        </div>

        <div class="actions">
            <button type="submit" [disabled]="!form.valid || loading" class="btn-primary">
                {{ loading ? 'Äang xá»­ lÃ½...' : 'LÆ°u' }}
            </button>
            <button type="button" (click)="cancel()" class="btn-secondary">Há»§y</button>
        </div>
    </form>
</div>