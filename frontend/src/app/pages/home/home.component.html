<div class="home-container">
    <div class="header-actions">
        <h1>Danh sÃ¡ch Báº¥t Äá»™ng Sáº£n</h1>
        <button (click)="goToCreate()" class="btn-create">â• ÄÄƒng Tin Má»›i</button>
    </div>

    <!-- Search & Filter Bar -->
    <div class="filter-bar">
        <input type="text" [(ngModel)]="filters.search" placeholder="ğŸ” TÃ¬m theo tÃªn, Ä‘á»‹a chá»‰, ngÆ°á»i Ä‘Äƒng..."
            class="filter-input search-input">

        <select [(ngModel)]="filters.listingTypeId" class="filter-input">
            <option [ngValue]="null">Táº¥t cáº£ loáº¡i</option>
            <option *ngFor="let lt of listingTypes" [ngValue]="lt.id">{{ lt.name }}</option>
        </select>

        <input type="number" [(ngModel)]="filters.minPrice" placeholder="GiÃ¡ tá»« (VND)" class="filter-input price-input">
        <input type="number" [(ngModel)]="filters.maxPrice" placeholder="GiÃ¡ Ä‘áº¿n (VND)"
            class="filter-input price-input">

        <button (click)="loadProperties()" class="btn-filter">ğŸ” TÃ¬m kiáº¿m</button>
        <button (click)="resetFilters()" class="btn-reset">â†º XÃ³a lá»c</button>
    </div>

    <div class="property-grid">
        <div *ngFor="let prop of properties" class="property-card">
            <div class="card-image-container" [routerLink]="['/properties', prop.id]" style="cursor: pointer;">
                <img [src]="prop.imageUrl ? 'http://localhost:3000' + prop.imageUrl : 'assets/house-placeholder.jpg'"
                    alt="Property Image" class="property-img">
                <button class="heart-btn" (click)="toggleLike(prop, $event)" [class.liked]="prop.liked">
                    â¤ï¸
                </button>
            </div>
            <div class="property-info" [routerLink]="['/properties', prop.id]" style="cursor: pointer;">
                <span class="type-badge" [ngClass]="prop.listingType?.code === 'rent' ? 'rent' : 'sale'">
                    {{ prop.listingType?.name || 'Báº¥t Ä‘á»™ng sáº£n' }}
                </span>
                <h3>{{ prop.title }}</h3>
                <p class="price">{{ prop.price | number }} VND</p>
                <p class="address">ğŸ“ {{ prop.address }}</p>
                <p class="area" *ngIf="prop.area">ğŸ“ {{ prop.area }} mÂ²</p>
                <p class="location" *ngIf="prop.district">
                    ğŸ™ï¸ {{ prop.district.name }}<span *ngIf="prop.district.city">, {{ prop.district.city.name }}</span>
                </p>
            </div>
            <div class="poster-info" *ngIf="prop.owner">
                <img [src]="prop.owner.avatar ? 'http://localhost:3000' + prop.owner.avatar : 'assets/default-avatar.png'"
                    alt="Poster Avatar" class="poster-avatar">
                <div class="poster-details">
                    <span class="poster-name">{{ prop.owner.fullName }}</span>
                    <span class="poster-phone" *ngIf="prop.owner.phone">ğŸ“ {{ prop.owner.phone }}</span>
                </div>
            </div>
            <div class="card-actions">
                <button [routerLink]="['/booking', prop.id]" class="btn-booking" (click)="$event.stopPropagation()">
                    ğŸ“… Äáº·t lá»‹ch / LiÃªn há»‡
                </button>
            </div>
        </div>
    </div>

    <div *ngIf="properties.length === 0" class="no-properties">
        <p>ChÆ°a cÃ³ tin Ä‘Äƒng nÃ o.</p>
    </div>
</div>